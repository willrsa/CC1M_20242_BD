-- Criação do banco de dados
CREATE DATABASE IF NOT EXISTS EmpresaDB;
USE EmpresaDB;

-- Tabela FORNECEDORES
CREATE TABLE FORNECEDORES (
    FORNECEDORES_COD INT PRIMARY KEY,
    FORNECEDORES_NOME VARCHAR(45) NOT NULL,
    FORNECEDORES_RUA VARCHAR(45),
    FORNECEDORES_NUMRUA INT,
    FORNECEDORES_BAIRRO VARCHAR(45),
    FORNECEDORES_CIDADE VARCHAR(45),
    FORNECEDORES_ESTADO VARCHAR(45),
    FORNECEDORES_PAIS VARCHAR(30),
    FORNECEDORES_CODPOSTAL VARCHAR(10),
    FORNECEDORES_TELEFONE VARCHAR(15),
    FORNECEDORES_CONTATO TEXT
);

-- Tabela PRODUTOS
CREATE TABLE PRODUTOS (
    PRODUTOS_COD INT PRIMARY KEY,
    PRODUTOS_NOME VARCHAR(50) NOT NULL,
    PRODUTOS_DESCRICAO TEXT,
    PRODUTOS_ESPECIF TEXT,
    PRODUTOS_QUANT DECIMAL(10,3),
    PRODUTOS_PRECOUNIT DECIMAL(10,2),
    PRODUTOS_UNIDADEMEDIDA VARCHAR(10),
    PRODUTOS_ESTOQ_MIN DECIMAL(10,3)
);

-- Tabela PEDIDOS
CREATE TABLE PEDIDOS (
    PEDIDOS_COD INT PRIMARY KEY,
    PEDIDOS_DATA DATE,
    PEDIDOS_HORA TIME,
    PEDIDOS_PREVISAO DATE,
    PEDIDOS_STATUS VARCHAR(20),
    FORNECEDORES_FORNECEDORES_COD INT,
    FOREIGN KEY (FORNECEDORES_FORNECEDORES_COD) REFERENCES FORNECEDORES(FORNECEDORES_COD)
);

-- Tabela RECEBIMENTOS
CREATE TABLE RECEBIMENTOS (
    RECEBIMENTOS_DATA DATE,
    RECEBIMENTOS_HORA TIME,
    RECEBIMENTOS_QUANT_PROD DECIMAL(10,3),
    RECEBIMENTOS_CONDICAO TEXT,
    PEDIDOS_PEDIDOS_COD INT,
    FOREIGN KEY (PEDIDOS_PEDIDOS_COD) REFERENCES PEDIDOS(PEDIDOS_COD)
);

-- Tabela FILIAIS
CREATE TABLE FILIAIS (
    FILIAIS_COD INT PRIMARY KEY,
    FILIAIS_NOME VARCHAR(30) NOT NULL,
    FILIAIS_RUA VARCHAR(100),
    FILIAIS_NUMRUA INT,
    FILIAIS_BAIRRO VARCHAR(50),
    FILIAIS_CIDADE VARCHAR(50),
    FILIAIS_ESTADO VARCHAR(30),
    FILIAIS_PAIS VARCHAR(30),
    FILIAIS_CODPOSTAL VARCHAR(10),
    FILIAIS_CAPACIDADE TEXT
);

-- Tabela FORNECEDORES_PRODUTOS (tabela associativa entre FORNECEDORES e PRODUTOS)
CREATE TABLE FORNECEDORES_PRODUTOS (
    FORNECEDORES_FORNECEDORES_COD INT,
    PRODUTOS_PRODUTOS_COD INT,
    PRIMARY KEY (FORNECEDORES_FORNECEDORES_COD, PRODUTOS_PRODUTOS_COD),
    FOREIGN KEY (FORNECEDORES_FORNECEDORES_COD) REFERENCES FORNECEDORES(FORNECEDORES_COD),
    FOREIGN KEY (PRODUTOS_PRODUTOS_COD) REFERENCES PRODUTOS(PRODUTOS_COD)
);

CREATE TABLE PEDIDOS_PRODUTOS (
    PEDIDOS_PEDIDOS_COD INT,
    PRODUTOS_PRODUTOS_COD INT,
    PEDIDOS_PRODUTOS_QUANT DECIMAL(10,3),
    PRIMARY KEY (PEDIDOS_PEDIDOS_COD, PRODUTOS_PRODUTOS_COD),
    FOREIGN KEY (PEDIDOS_PEDIDOS_COD) REFERENCES PEDIDOS(PEDIDOS_COD),
    FOREIGN KEY (PRODUTOS_PRODUTOS_COD) REFERENCES PRODUTOS(PRODUTOS_COD)
);

-- Tabela FILIAIS_PRODUTOS (tabela associativa entre FILIAIS e PRODUTOS)
CREATE TABLE FILIAIS_PRODUTOS (
    FILIAIS_FILIAIS_COD INT,
    PRODUTOS_PRODUTOS_COD INT,
    FILIAIS_PRODUTOS_QUANT DECIMAL(10,3),
    PRIMARY KEY (FILIAIS_FILIAIS_COD, PRODUTOS_PRODUTOS_COD),
    FOREIGN KEY (FILIAIS_FILIAIS_COD) REFERENCES FILIAIS(FILIAIS_COD),
    FOREIGN KEY (PRODUTOS_PRODUTOS_COD) REFERENCES PRODUTOS(PRODUTOS_COD)
);

INSERT INTO FORNECEDORES (FORNECEDORES_COD, FORNECEDORES_NOME, FORNECEDORES_RUA, FORNECEDORES_NUMRUA, FORNECEDORES_BAIRRO, FORNECEDORES_CIDADE, FORNECEDORES_ESTADO, FORNECEDORES_PAIS, FORNECEDORES_CODPOSTAL, FORNECEDORES_TELEFONE, FORNECEDORES_CONTATO)
VALUES (1, 'Fornecedor A', 'Rua A', 123, 'Centro', 'São Paulo', 'SP', 'Brasil', '00000-001', '1122223333', 'João Silva');
INSERT INTO FORNECEDORES VALUES (2, 'Fornecedor B', 'Av. Beta', 456, 'Bairro Novo', 'Rio de Janeiro', 'RJ', 'Brasil', '22020-000', '1133334444', 'Maria Oliveira');
INSERT INTO FORNECEDORES VALUES (3, 'Fornecedor C', 'Rua Gama', 789, 'Jardins', 'Belo Horizonte', 'MG', 'Brasil', '31030-000', '1144445555', 'Carlos Sousa');
INSERT INTO FORNECEDORES VALUES (4, 'Fornecedor D', 'Av. Delta', 101, 'Liberdade', 'Curitiba', 'PR', 'Brasil', '80040-000', '1155556666', 'Ana Costa');
INSERT INTO FORNECEDORES VALUES (5, 'Fornecedor E', 'Rua Épsilon', 202, 'Centro', 'Porto Alegre', 'RS', 'Brasil', '90050-000', '1166667777', 'Pedro Lima');

UPDATE FORNECEDORES SET FORNECEDORES_TELEFONE = '1177778888' WHERE FORNECEDORES_COD = 1;
UPDATE FORNECEDORES SET FORNECEDORES_CONTATO = 'Paula Fernandes' WHERE FORNECEDORES_COD = 3;

DELETE FROM FORNECEDORES WHERE FORNECEDORES_COD = 5;

-- TABELA: PRODUTOS
INSERT INTO PRODUTOS (PRODUTOS_COD, PRODUTOS_NOME, PRODUTOS_DESCRICAO, PRODUTOS_ESPECTEC, PRODUTOS_QUANT, PRODUTOS_PRECOUNT, PRODUTOS_UNIDADEMEDIDA, PRODUTOS_ESTOQ_MIN)
VALUES (1, 'Produto X', 'Descrição Produto X', 'Especificação X', 100, 50.00, 'UN', 20);
INSERT INTO PRODUTOS VALUES (2, 'Produto Y', 'Descrição Produto Y', 'Especificação Y', 200, 75.00, 'UN', 50);
INSERT INTO PRODUTOS VALUES (3, 'Produto Z', 'Descrição Produto Z', 'Especificação Z', 300, 100.00, 'UN', 100);
INSERT INTO PRODUTOS VALUES (4, 'Produto W', 'Descrição Produto W', 'Especificação W', 400, 150.00, 'UN', 150);
INSERT INTO PRODUTOS VALUES (5, 'Produto V', 'Descrição Produto V', 'Especificação V', 500, 200.00, 'UN', 200);

UPDATE PRODUTOS SET PRODUTOS_PRECOUNT = 55.00 WHERE PRODUTOS_COD = 1;
UPDATE PRODUTOS SET PRODUTOS_QUANT = 180 WHERE PRODUTOS_COD = 2;

DELETE FROM PRODUTOS WHERE PRODUTOS_COD = 5;

-- TABELA: FORNECEDORES_PRODUTOS
INSERT INTO FORNECEDORES_PRODUTOS (FORNECEDORES_FORNECEDORES_COD, PRODUTOS_PRODUTOS_COD) VALUES (1, 1);
INSERT INTO FORNECEDORES_PRODUTOS VALUES (1, 2);
INSERT INTO FORNECEDORES_PRODUTOS VALUES (2, 3);
INSERT INTO FORNECEDORES_PRODUTOS VALUES (3, 4);
INSERT INTO FORNECEDORES_PRODUTOS VALUES (4, 5);

UPDATE FORNECEDORES_PRODUTOS SET FORNECEDORES_FORNECEDORES_COD = 2 WHERE PRODUTOS_PRODUTOS_COD = 2;
UPDATE FORNECEDORES_PRODUTOS SET PRODUTOS_PRODUTOS_COD = 4 WHERE FORNECEDORES_FORNECEDORES_COD = 1;

DELETE FROM FORNECEDORES_PRODUTOS WHERE FORNECEDORES_FORNECEDORES_COD = 4 AND PRODUTOS_PRODUTOS_COD = 5;

-- TABELA: PEDIDOS
INSERT INTO PEDIDOS (PEDIDOS_COD, PEDIDOS_DATA, PEDIDOS_HORA, PEDIDOS_PREVISAO, PEDIDOS_STATUS, FORNECEDORES_FORNECEDORES_COD)
VALUES (1, '2024-11-01', '08:00:00', '2024-11-10', 'Pendente', 1);
INSERT INTO PEDIDOS VALUES (2, '2024-11-02', '09:30:00', '2024-11-11', 'Concluído', 2);
INSERT INTO PEDIDOS VALUES (3, '2024-11-03', '10:00:00', '2024-11-12', 'Pendente', 3);
INSERT INTO PEDIDOS VALUES (4, '2024-11-04', '11:30:00', '2024-11-13', 'Cancelado', 4);
INSERT INTO PEDIDOS VALUES (5, '2024-11-05', '12:00:00', '2024-11-14', 'Pendente', 5);

UPDATE PEDIDOS SET PEDIDOS_STATUS = 'Concluído' WHERE PEDIDOS_COD = 1;
UPDATE PEDIDOS SET PEDIDOS_PREVISAO = '2024-11-15' WHERE PEDIDOS_COD = 2;

DELETE FROM PEDIDOS WHERE PEDIDOS_COD = 4;

-- TABELA: PEDIDOS_PRODUTOS
INSERT INTO PEDIDOS_PRODUTOS (PEDIDOS_PEDIDOS_COD, PRODUTOS_PRODUTOS_COD, PEDIDOS_PRODUTOS_QUANT)
VALUES (1, 1, 50);
INSERT INTO PEDIDOS_PRODUTOS VALUES (1, 2, 30);
INSERT INTO PEDIDOS_PRODUTOS VALUES (2, 3, 100);
INSERT INTO PEDIDOS_PRODUTOS VALUES (3, 4, 200);
INSERT INTO PEDIDOS_PRODUTOS VALUES (4, 5, 150);

UPDATE PEDIDOS_PRODUTOS SET PEDIDOS_PRODUTOS_QUANT = 60 WHERE PEDIDOS_PEDIDOS_COD = 1 AND PRODUTOS_PRODUTOS_COD = 1;
UPDATE PEDIDOS_PRODUTOS SET PRODUTOS_PRODUTOS_COD = 5 WHERE PEDIDOS_PEDIDOS_COD = 3;

DELETE FROM PEDIDOS_PRODUTOS WHERE PEDIDOS_PEDIDOS_COD = 4 AND PRODUTOS_PRODUTOS_COD = 5;

-- TABELA: RECEBIMENTOS
INSERT INTO RECEBIMENTOS (RECEBIMENTOS_DATA, RECEBIMENTOS_HORA, RECEBIMENTOS_QUANT_PROD, RECEBIMENTOS_CONDICAO, PEDIDOS_PEDIDOS_COD)
VALUES ('2024-11-06', '14:00:00', 50, 'Aprovado', 1);
INSERT INTO RECEBIMENTOS VALUES ('2024-11-07', '15:00:00', 100, 'Aprovado', 2);
INSERT INTO RECEBIMENTOS VALUES ('2024-11-08', '16:30:00', 150, 'Reprovado', 3);
INSERT INTO RECEBIMENTOS VALUES ('2024-11-09', '17:00:00', 200, 'Aprovado', 4);
INSERT INTO RECEBIMENTOS VALUES ('2024-11-10', '18:00:00', 250, 'Pendente', 5);

UPDATE RECEBIMENTOS SET RECEBIMENTOS_CONDICAO = 'Revisado' WHERE PEDIDOS_PEDIDOS_COD = 1;
UPDATE RECEBIMENTOS SET RECEBIMENTOS_QUANT_PROD = 120 WHERE PEDIDOS_PEDIDOS_COD = 2;

DELETE FROM RECEBIMENTOS WHERE PEDIDOS_PEDIDOS_COD = 3;
